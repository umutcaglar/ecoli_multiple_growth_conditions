# ecoli_multiple_growth_conditions
the main repository for E.coli multiple growth condition experiments.


The folder mainly composes of 5 differs categories of folders

a.) dataPreperation_RNA&Protein
b.) histogram_RNA&Protein
c.) change_wrt_variables_RNA&Protein
d.) Mf_Pathway_Analyze
e.) Flux_Analyze

each category have 3 sobfolders "code", "results", "figures"
For each category script files are inside code folders the result files are inside "results" folders and figures are in "figures" folders.

As an example "c_figures" folder includes figures generated by the the files in the folder "c_code_change_wrt_variables_RNA&Protein"

In addition to them we have data folders named 
 DoublingTimeRawData
 Flux_reads_06_21_2016
 Protein_reads_06_16_2016
 RNA_reads_06_13_2016
which includes data files that are associated with doubling time, flux, protein and ran reads 

We also have a text folder that includes stuff related with manuscript and a dictionary folder that includes files that map "YP" names for proteins to "ECB" names for RNA's

Protein and RNA raw files are txt files that includes counts and gene / protein names

THE PIPELINE MAINLY FOLLOW ALPHABETICAL ORDER in folder category name "a", "b", "c", "d", "e"

A- dataPreperation_RNA&Protein
Aim is to combine distinct count files into single unique ones for mRNA and proteins; then generate the meta data file associated with them. 

 generating_RNA_RawCount.R
 generating_Protein_RawCount.R
 generating_Meta_data.R

do this steps

 fun_order.R

is a function that changes orders of columns in data frame, knows before, after, first, last.

 doublingTime.R
generates the fig2 in this paper

 qualityControl_mRNA.R
 qualityControl_protein.R 
does measures the variation in between replicates

 data_name_example.R
 data_naming_functions.R

 data_normalization.R
 data_filter_normalization_functions.R

"data_normalization.R" script calls functions from "data_filter_normalization_functions.R" and the aim of the script is to generate relevant deSeq2 object that is composed of relevant data which is normalized by DeSeq size factors 

"data_normalization.R" generates 2 csv files for each run
one of them is meta files that includes information about data used
other one is resultant data frame file that includes actual normalized count data
generated files includes filenames begin with resDd_... and metaDara_... respectively rest of the filenames give information about used subset of the data

B- histogram_RNA&Protein this folder generate heat map figures for proteins and for ran. Also calculates the table1

 heatMapFigureProtein.R generates protein heatmap (fig4 for the paper)
 heatMapFigureRNA.R generates RNA heat map (fig3 for the paper)
 distance_table.R generates distance table by using the functions in "distance_table_functions.R"

 replace_fun is a useful function that replaces selected elements in a vector with desired ones.
 
Output heat maps are stored in b_figures

C- change_wrt_variables_RNA&Protein

the aim of the folder is to find enriched genes with help of DeSeq2 for given datasets.
the DeSeq objects are generated with the help of 
"../a_code_dataPreperation_RNA&Protein/data_filter_normalization_functions.R"

 data_normalization_DeSeq2.R generated a DeSeq2 run with given parameters and given subdataset
with design formula given by
 "DESeq2::design(deseq_DataObj)<- as.formula(paste0("~ ","batchNumber + ",test_for))"
 where test for is the test we are interested in

 data_normalization_DeSeq2_multiple.R does the same with multiple subsets and with multiple tests

 data_normalization_DeSeq2_growthRate_multiple.R does the same with same multiple subsets and with same multiple tests but this time the design formula is:
 DESeq2::design(deseq_DataObj)<- as.formula(paste0("~ ","batchNumber + ",test_for," + doublingTimeMinutes"))

 the outputs of all these 3 files are stored in c_results, each run generated 4 outputs (all are csv files)
1. the meta data file the file that keeps the properties and names of the data sets that goes inside DeSeq2 (metaData... .csv)
2. resultant data frame is the data frame output of DeSeq2 run that includes p values and gene names, log2fold changes base level and contrast as well (resDf... .csv)
3. genes: the gene names that changes at least 2 fold with a p value less than 0.05 (genes_... .csv)
4. the ez names corresponding to those gene names (ez_... .csv)

 DAVIDWebInterface.R  calls ez file generated from DeSeq2 and send them to DAVID gene annotation analysis web service for enrichment analysis. Each run generates 3 outputs under c_results/david_results. one for enriched kegg pathways and second is for enriched molecular functions with old version of DAVID and third is for enriched molecular functions with new version of DAVID. Those 3 file names end with "..._kegg.csv", "..._mf_o.csv", "...mf_n.csv" respectively

 DAVIDWebInterface_multiple.R 
does the same multiple times for all generated ez files.

 webTest.R is a file to test connection to DAVID web interface

 difExpGene_Figures.R 
generate fig5 and fig6 for the paper.

 /test_DeSeq2/ folder includes file to generate some test to understand the behavior of DeSeq under different circumstances.

D- Mf Pathway Analyse 
   Aim of the folder is to generate some figures from results of DAVID runs
   supplementaryFigureMarkdown.Rmd calls multiple files there to generate supplementary text pdf named "supplementaryFigureMarkdown.pdf"

 summaryFigures.R generate fig7 and figS1
 combinedMainTextFigure.R generates fig8

 DESeq_David_MF_multiple.R and DESeq_David_kegg_multiple.R generate figS2 ... figS22

E- FLUX Analysis 
   Aim of this folder is to do the flux data analysis.
   FluxSaltStressAnalyze.R generates concentration vs flux figures for RNA and Proteins and for exponential (figS23) and stationary phases.

   FluxDoublingTimeSaltStressAnalyze.R generates analyze change in flux wrt doubling times and generate fig9 
 


 






