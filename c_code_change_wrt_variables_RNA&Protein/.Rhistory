theme(text = element_text(size =18)) +
ylab ("Frequency") +
xlab ("Number of Base Pairs") +
labs (fill = "")
table_experiment %>%
dplyr::arrange(Number.of.Base.Pair,cutoff) %>%
dplyr::group_by(Number.of.Base.Pair,cutoff) %>%
dplyr::summarise(dup_freq_sum=sum(Duplication.Freq))->table_experiment2
table_experiment2$Percentage <- table_experiment2$dup_freq_sum/sum(table_experiment2$dup_freq_sum)*100
raw_experimental<-ggplot(table_experiment2,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("Experimental EBS1/IBS1: Number of Base Pairs Vs. Percentage") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
ggplot(table_experiment2,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("Experimental EBS1/IBS1: Number of Base Pairs Vs. Percentage") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
table_ebsIBS1simulated_lessthan3$cutoff = 0
table_ebsIBS1simulated_morethan2$cutoff = 1
simulated_raw <- rbind(table_ebsIBS1simulated_lessthan3, table_ebsIBS1simulated_morethan2)
simulated_raw %>%
dplyr::arrange(Number.of.Base.Pair,cutoff) %>%
dplyr::group_by(Number.of.Base.Pair,cutoff) %>%
dplyr::summarise(dup_freq_sum=sum(Duplication.Freq))->simulated_raw_organized
simulated_raw_organized$Percentage <- simulated_raw_organized$dup_freq_sum/sum(simulated_raw_organized$dup_freq_sum)*100
raw_simul<-ggplot(simulated_raw_organized,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("Simulated EBS1/IBS1: Number of Base Pairs Vs. Percentage") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
ggplot(simulated_raw_organized,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("Simulated EBS1/IBS1: Number of Base Pairs Vs. Percentage") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
colnames(table_experiment2)
colnames(simulated_raw_organized)
nrow(simulated_raw_organized)
View(simulated_raw_organized)
nrow(table_experiment2)
table_experiment2->
dplyr::mutate(dataSource="experiment")->table_experiment2
simulated_raw_organized->
dplyr::mutate(dataSource="simulated")->simulated_raw_organized
dplyr::rbind_list(table_experiment2, simulated_raw_organized)->dataFrame
View(dataFrame)
source('~/Desktop/seanData/20160624_basePairVsFreq_RawOrUniqVsSimul.R', echo=TRUE)
View(dataFrame)
raw_simul<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("Simulated EBS1/IBS1: Number of Base Pairs Vs. Percentage") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
#****************
source('~/Desktop/seanData/20160624_basePairVsFreq_RawOrUniqVsSimul.R', echo=TRUE)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
View(overalPlot)
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge())
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("combined") +
theme(text = element_text(size =18))
View(overalPlot)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge()) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
print(overalPlot)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge(),aplha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
print(overalPlot)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage))+
geom_bar(stat = "identity", position=position_dodge(),alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
print(overalPlot)
View(dataFrame)
dataFrame
source('~/Desktop/seanData/20160624_basePairVsFreq_RawOrUniqVsSimul.R', echo=TRUE)
source('~/Desktop/seanData/20160624_basePairVsFreq_RawOrUniqVsSimul.R', echo=TRUE)
dataFrame %>%
dplyr::mutate(barColor=ifelse(dataSource=="experiment" & cutoff==0, "#e41a1c", NA),
barColor=ifelse(dataSource=="experiment" & cutoff==1, "#377eb8", barColor),
barColor=ifelse(dataSource=="simulated" & cutoff==0, "#4daf4a", barColor),
barColor=ifelse(dataSource=="simulated" & cutoff==1, "#984ea3", barColor))->dataFrame
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage,
color=barColor))+
geom_bar(stat = "identity", position=position_dodge(),alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
print(overalPlot)
#****************
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
fill=factor(cutoff),
y=Percentage,
fill=barColor))+
geom_bar(stat = "identity", position=position_dodge(),alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
print(overalPlot)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
y=Percentage,
fill=barColor))+
geom_bar(stat = "identity", position=position_dodge(),alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "")
print(overalPlot)
overalPlot<-ggplot(aes(x=factor(Number.of.Base.Pair),
y=Percentage,
fill=barColor))+
geom_bar(data = table_experiment2,stat = "identity", position=position_dodge(),alpha=.3)
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
y=Percentage,
fill=barColor))+
geom_bar(data = table_experiment2,stat = "identity", position=position_dodge(),alpha=.3)
dataFrame %>%
dplyr::filter(dataSource=="simulated")->simulatedDf
dataFrame %>%
dplyr::filter(dataSource=="experiment")->experimentDf
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
y=Percentage,
fill=barColor))+
geom_bar(data = simulatedDf,stat = "identity", position=position_dodge(),alpha=.3)
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),
y=Percentage,
fill=barColor))+
geom_bar(data = simulatedDf,stat = "identity", position=position_dodge(),alpha=.3)
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3)
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_bar(data = experimentDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3)
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_bar(data = experimentDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_classic()
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_bar(data = experimentDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bf()
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_bar(data = experimentDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bw()
print(overalPlot)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_line(data = experimentDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bw()
print(overalPlot)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_line(data = experimentDf,
aes(color=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bw()
print(overalPlot)
overalPlot<-ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_line(data = experimentDf,
aes(color=barColor)) +
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bw()
print(overalPlot)
dataFrame
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=.3) +
geom_line(data = experimentDf,
aes(color=barColor))
ggplot(dataFrame,aes(x=factor(Number.of.Base.Pair),y=Percentage))+
# geom_bar(data = simulatedDf,
#          aes(fill=barColor),
#          stat = "identity",
#          position=position_dodge(),
#          alpha=.3) +
geom_line(data = experimentDf,
aes(color=barColor)) +
ggtitle("combined")
experimentDf
ggplot(dataFrame)+
# geom_bar(data = simulatedDf,
#          aes(fill=barColor),
#          stat = "identity",
#          position=position_dodge(),
#          alpha=.3) +
geom_line(data = experimentDf,
aes(color=barColor,aes(x=factor(Number.of.Base.Pair),y=Percentage)))
ggplot()+
geom_line(data = experimentDf,
aes(color=barColor,aes(x=factor(Number.of.Base.Pair),y=Percentage)))
ggplot()+
geom_line(data = experimentDf,
aes(color=barColor,x=factor(Number.of.Base.Pair),y=Percentage))
ggplot()+
geom_line(data = experimentDf,aes(x=factor(Number.of.Base.Pair),y=Percentage))
ggplot()+
geom_line(data = experimentDf,aes(x=Number.of.Base.Pair,y=Percentage))
ggplot()+
geom_line(data = experimentDf,aes(x=Number.of.Base.Pair,y=Percentage,color=barColor))
ggplot()+
geom_line(data = experimentDf,aes(x=Number.of.Base.Pair,y=Percentage,color=barColor))
ggplot()+
geom_line(data = experimentDf,aes(x=Number.of.Base.Pair,y=Percentage,color=barColor))+
geom_bar(data = simulatedDf,
aes(fill=barColor),
stat = "identity",
position=position_dodge())
ggplot()+
geom_line(data = experimentDf,aes(x=Number.of.Base.Pair,y=Percentage,color=barColor))+
geom_bar(data = simulatedDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=barColor),
stat = "identity",
position=position_dodge())
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,color=barColor))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,color=barColor))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=barColor),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage),
stat = "identity",
position=position_dodge(),
alpha=0.5)
simulatedDf
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,group=cutoff))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,group=cutoff))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,group=cutoff),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,group=cutoff))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=cutoff),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,group=cutoff))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=factor(cutoff)),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,fill=factor(cutoff)))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=factor(cutoff)),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,color=factor(cutoff)))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=factor(cutoff)),
stat = "identity",
position=position_dodge(),
alpha=0.5)
ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,color=factor(cutoff)))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=factor(cutoff)),
stat = "identity",
position=position_dodge(),
alpha=0.5)+
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bw()
print(overalPlot)
overalPlot<-ggplot()+
geom_line(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,color=factor(cutoff)))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=factor(cutoff)),
stat = "identity",
position=position_dodge(),
alpha=0.5)+
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bw()
print(overalPlot)
49240*1.5/960
View(simulatedDf)
View(simulatedDf)
overalPlot<-ggplot()+
geom_point(data = simulatedDf,aes(x=Number.of.Base.Pair,y=Percentage,color=factor(cutoff)))+
geom_bar(data = experimentDf,
aes(x=Number.of.Base.Pair,y=Percentage,fill=factor(cutoff)),
stat = "identity",
position=position_dodge(),
alpha=0.5)+
ggtitle("combined") +
theme(text = element_text(size =18)) +
ylab ("Percentage") +
xlab ("Number of Base Pairs") +
labs (fill = "") +
theme_bw()
print(overalPlot)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
View(df_combined)
colnames(df_combined)
df_combined %>%
dplyr::filter(!is.na(padj))%>%
dplyr::group_by(contrast,base,signChange) %>%
dplyr::filter(padj<0.05 & abs(log2FoldChange)>1)%>%
dplyr::summarise(P0.05Fold2=length(padj),
growthPhase=unique(growthPhase),
data_type=unique(pick_data))->df_summary_exp_mrna
df_combined %>%
dplyr::filter(!is.na(padj))%>%
dplyr::group_by(contrast,base,signChange) %>%
dplyr::filter(padj<0.05 & abs(log2FoldChange)>1)%>%
dplyr::summarise(P0.05Fold2=length(padj),
growthPhase=unique(growthPhase),
data_type=unique(pick_data))->df_summary_exp_mrna
df_combined %>%
dplyr::filter(base=="baseNa",contrast=="highNa",
padj<0.05, abs(log2FoldChange)>1)->temp
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
df_summary
debugSource('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
df_summary
df_summary
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/data_normalization_DeSeq2_multiple.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/data_normalization_DeSeq2_multiple.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
df_summary
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/data_normalization_DeSeq2_multiple.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/data_normalization_DeSeq2_multiple.R', echo=TRUE)
source('~/GitHub/ecoli_multiple_growth_conditions/c_code_change_wrt_variables_RNA&Protein/difExpGene_Figures.R', echo=TRUE)
